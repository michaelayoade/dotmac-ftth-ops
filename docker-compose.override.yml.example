# Docker Compose Override for Local Development
#
# Copy this file to docker-compose.override.yml for local testing
# DO NOT commit docker-compose.override.yml to Git
#
# Usage:
#   cp docker-compose.override.yml.example docker-compose.override.yml
#   docker compose up -d
#
# WARNING: This file enables test users and weak secrets - LOCAL DEV ONLY!

version: '3.8'

services:
  freeradius:
    environment:
      # Override localhost secret for testing
      - RADIUS_LOCALHOST_SECRET=testing123

    volumes:
      # Mount test authorize file (contains test/test user)
      # WARNING: This bypasses authentication - LOCAL DEV ONLY!
      - ./config/radius/authorize.test:/etc/raddb/mods-config/files/authorize

      # Mount test clients file (contains weak secrets and wide CIDRs)
      # WARNING: Highly permissive - LOCAL DEV ONLY!
      - ./config/radius/clients.test.conf:/etc/freeradius/clients.conf

    healthcheck:
      # Healthcheck will now work with test/test user
      test: ["CMD", "radtest", "test", "test", "localhost", "0", "testing123"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
