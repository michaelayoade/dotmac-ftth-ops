# Tenant Environment Configuration
# Generated by Ansible provision-tenant.yml playbook
# Tenant ID: {{ tenant_id }}
# Instance ID: {{ instance_id }}
# Environment: {{ environment }}

# Deployment
DEPLOYMENT_ENV={{ deployment_env | default('vm') }}
ENVIRONMENT={{ environment }}
TENANT_ID={{ tenant_id }}
INSTANCE_ID={{ instance_id }}

# Application
APP_PORT={{ app_port }}
APP_HOST=0.0.0.0
DEBUG={{ debug | default('false') }}
LOG_LEVEL={{ log_level | default('INFO') }}

# Database
DATABASE_HOST={{ db_host }}
DATABASE_PORT={{ db_port | default('5432') }}
DATABASE_NAME=tenant_{{ tenant_id }}
DATABASE_USER=tenant_{{ tenant_id }}_user
DATABASE_PASSWORD={{ db_password }}
DATABASE_URL=postgresql://tenant_{{ tenant_id }}_user:{{ db_password }}@{{ db_host }}:{{ db_port | default('5432') }}/tenant_{{ tenant_id }}
DATABASE_URL_ASYNC=postgresql+asyncpg://tenant_{{ tenant_id }}_user:{{ db_password }}@{{ db_host }}:{{ db_port | default('5432') }}/tenant_{{ tenant_id }}

# Redis
REDIS_HOST={{ redis_host }}
REDIS_PORT={{ redis_port | default('6379') }}
REDIS_PASSWORD={{ redis_password }}
REDIS_DB={{ redis_db | default('0') }}
REDIS_URL=redis://:{{ redis_password }}@{{ redis_host }}:{{ redis_port | default('6379') }}/{{ redis_db | default('0') }}

# Celery
CELERY_BROKER_URL=redis://:{{ redis_password }}@{{ redis_host }}:{{ redis_port | default('6379') }}/1
CELERY_RESULT_BACKEND=redis://:{{ redis_password }}@{{ redis_host }}:{{ redis_port | default('6379') }}/2

# Vault / Secrets Management
VAULT_ADDR={{ vault_addr }}
VAULT_TOKEN={{ vault_token }}
VAULT_NAMESPACE={{ vault_namespace | default('tenant_' + tenant_id) }}

# RADIUS Configuration
RADIUS_SERVER_HOST={{ radius_host }}
RADIUS_SERVER_PORT={{ radius_port | default('1812') }}
RADIUS_COA_PORT={{ radius_coa_port | default('3799') }}
RADIUS_SECRET={{ radius_secret }}
RADIUS_DICTIONARY_PATH={{ radius_dictionary_path | default('/etc/raddb/dictionary') }}

# OSS Integrations
NETBOX_URL={{ netbox_url }}
NETBOX_API_TOKEN={{ netbox_api_token }}
GENIEACS_URL={{ genieacs_url }}
GENIEACS_USERNAME={{ genieacs_username }}
GENIEACS_PASSWORD={{ genieacs_password }}
VOLTHA_URL={{ voltha_url | default('') }}
AWX_URL={{ awx_url }}
AWX_API_TOKEN={{ awx_api_token }}

# Monitoring
PROMETHEUS_URL={{ prometheus_url | default('http://prometheus:9090') }}
OTEL_EXPORTER_OTLP_ENDPOINT={{ otel_endpoint | default('http://otel-collector:4318/v1/traces') }}
ENABLE_METRICS={{ enable_metrics | default('true') }}
ENABLE_TRACING={{ enable_tracing | default('true') }}

# Security
SECRET_KEY={{ secret_key }}
JWT_SECRET_KEY={{ jwt_secret_key }}
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES={{ jwt_expiration_minutes | default('30') }}
CORS_ORIGINS=["https://{{ tenant_subdomain }}.{{ domain }}"{% if custom_domain %}, "https://{{ custom_domain }}"{% endif %}]

# Rate Limiting
RATE_LIMIT_ENABLED={{ rate_limit_enabled | default('true') }}
RATE_LIMIT_PER_SECOND={{ rate_limit_per_second | default('10') }}

# File Storage
FILE_STORAGE_BACKEND={{ file_storage_backend | default('local') }}
FILE_STORAGE_PATH={{ data_dir }}/uploads
{% if file_storage_backend == 's3' %}
S3_BUCKET_NAME={{ s3_bucket_name }}
S3_ACCESS_KEY_ID={{ s3_access_key_id }}
S3_SECRET_ACCESS_KEY={{ s3_secret_access_key }}
S3_REGION={{ s3_region }}
{% endif %}

# Email Configuration
SMTP_HOST={{ smtp_host | default('localhost') }}
SMTP_PORT={{ smtp_port | default('587') }}
SMTP_USER={{ smtp_user | default('') }}
SMTP_PASSWORD={{ smtp_password | default('') }}
SMTP_FROM_EMAIL={{ smtp_from_email | default('noreply@' + domain) }}
SMTP_USE_TLS={{ smtp_use_tls | default('true') }}

# Tenant Branding (for emails, notifications)
TENANT_NAME={{ tenant_name }}
TENANT_DOMAIN={{ tenant_subdomain }}.{{ domain }}
TENANT_LOGO_URL={{ tenant_logo_url | default('') }}
TENANT_PRIMARY_COLOR={{ tenant_primary_color | default('#0ea5e9') }}
TENANT_SUPPORT_EMAIL={{ tenant_support_email | default('support@' + domain) }}

# Feature Flags
FEATURE_RADIUS_ENABLED={{ features.radius_enabled | default('true') }}
FEATURE_WIREGUARD_ENABLED={{ features.wireguard_enabled | default('false') }}
FEATURE_BILLING_ENABLED={{ features.billing_enabled | default('true') }}
FEATURE_GRAPHQL_ENABLED={{ features.graphql_enabled | default('true') }}
FEATURE_WEBHOOKS_ENABLED={{ features.webhooks_enabled | default('true') }}

# Resource Limits
MAX_WORKERS={{ resources.max_workers | default('4') }}
MAX_DB_CONNECTIONS={{ resources.max_db_connections | default('20') }}
MAX_UPLOAD_SIZE={{ resources.max_upload_size | default('100M') }}

# Audit & Logging
AUDIT_LOG_ENABLED={{ audit_log_enabled | default('true') }}
AUDIT_LOG_PATH={{ data_dir }}/logs/audit.log
AUDIT_ARCHIVE_PATH={{ data_dir }}/audit/archive
LOG_FILE_PATH={{ data_dir }}/logs/app.log

# Data Directories
DATA_DIR={{ data_dir }}
INSTALL_DIR={{ install_dir }}

# Custom tenant-specific configuration
{% if tenant_config is defined %}
{% for key, value in tenant_config.items() %}
{{ key }}={{ value }}
{% endfor %}
{% endif %}
