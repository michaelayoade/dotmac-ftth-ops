# Virtual Server Configuration for Tenant {{ tenant_id }}
# Generated by Ansible

server tenant-{{ tenant_id }} {
    # Authorization
    authorize {
        filter_username
        preprocess
        suffix
        sql-tenant-{{ tenant_id }}

        # Check if user exists
        if (notfound) {
            reject
        }

        pap
    }

    # Authentication
    authenticate {
        Auth-Type PAP {
            pap
        }

        Auth-Type CHAP {
            chap
        }
    }

    # Pre-accounting
    preacct {
        preprocess
        suffix
        files
    }

    # Accounting
    accounting {
        sql-tenant-{{ tenant_id }}
    }

    # Session management
    session {
        sql-tenant-{{ tenant_id }}
    }

    # Post-authentication
    post-auth {
        sql-tenant-{{ tenant_id }}

        Post-Auth-Type REJECT {
            sql-tenant-{{ tenant_id }}
            attr_filter.access_reject
        }
    }

    # CoA (Change of Authorization)
    recv-coa {
        suffix
        sql-tenant-{{ tenant_id }}
    }

    send-coa {
    }
}
