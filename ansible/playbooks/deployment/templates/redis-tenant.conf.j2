# Redis configuration for tenant {{ tenant_id }}
# Generated by Ansible

# Network
bind 127.0.0.1
port {{ redis_port }}
protected-mode yes

# General
daemonize no
pidfile /var/run/redis/redis-tenant-{{ tenant_id }}.pid
loglevel notice
logfile {{ data_dir }}/redis/redis.log

# Security
requirepass {{ redis_password }}

# Persistence
dir {{ data_dir }}/redis
dbfilename dump-tenant-{{ tenant_id }}.rdb
save 900 1
save 300 10
save 60 10000

# Append-only file
appendonly yes
appendfilename "appendonly-tenant-{{ tenant_id }}.aof"
appendfsync everysec

# Memory management
maxmemory {{ resources.redis_max_memory | default('256mb') }}
maxmemory-policy allkeys-lru

# Limits
maxclients {{ resources.redis_max_clients | default('1000') }}

# Slow log
slowlog-log-slower-than 10000
slowlog-max-len 128
